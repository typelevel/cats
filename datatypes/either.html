<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Laika 0.18.1 + Helium Theme" />
    <title>Either</title>
    
      <meta name="author" content="Cody Allen"/>
    
      <meta name="author" content="Ross Baker"/>
    
      <meta name="author" content="Arman Bilge"/>
    
      <meta name="author" content="P. Oscar Boykin"/>
    
      <meta name="author" content="Travis Brown"/>
    
      <meta name="author" content="Adelbert Chang"/>
    
      <meta name="author" content="Daniel Esik"/>
    
      <meta name="author" content="Peter Neyens"/>
    
      <meta name="author" content="Rob Norris"/>
    
      <meta name="author" content="Erik Osheim"/>
    
      <meta name="author" content="LukaJCB"/>
    
      <meta name="author" content="Michael Pilquist"/>
    
      <meta name="author" content="Miles Sabin"/>
    
      <meta name="author" content="Daniel Spiewak"/>
    
      <meta name="author" content="Frank Thomas"/>
    
      <meta name="author" content="Sergey Torgashov"/>
    
      <meta name="author" content="Julien Truffaut"/>
    
      <meta name="author" content="Kailuo Wang"/>
    
    
      <meta name="description" content="docs"/>
    
    
      <link rel="icon" sizes="32x32" type="image/png" href="https://typelevel.org/img/favicon.png"/>
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.207/distr/fira_code.css">
    
    <link rel="stylesheet" type="text/css" href="../helium/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="../helium/laika-helium.css" />
    <link rel="stylesheet" type="text/css" href="../site/styles.css" />
    <script src="../helium/laika-helium.js"></script>
    <script src="../js/sponsors.js"></script>
    
    
    <script> /* for avoiding page load transitions */ </script>
  </head>

  <body>

    <header id="top-bar">

      <div class="row">
        <a id="nav-icon">
          <i class="icofont-laika" title="Navigation">&#xefa2;</i>
        </a>
        
      </div>

      <a class="image-link" href="https://typelevel.org"><img src="https://typelevel.org/img/logo.svg"></a>

      <span class="row links"><a class="icon-link svg-link" href="https://www.javadoc.io/doc/org.typelevel/cats-docs_2.13/2.9.0/"><span title="API"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M75,47.5c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm-50,-0c13.246,-0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,-0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm2.705,16.735l7.239,0l0.622,-4.904l-21.833,0l-0,4.904l7.589,0l0,22.067l6.383,0l-0,-22.067Zm58.076,7.265c-0,-8.757 -3.698,-14.166 -10.781,-14.166c-7.083,-0 -10.781,5.604 -10.781,14.166c0,8.757 3.698,14.166 10.781,14.166c7.083,0 10.781,-5.604 10.781,-14.166Zm-6.539,0c0,6.538 -1.128,9.496 -4.242,9.496c-2.997,0 -4.242,-2.88 -4.242,-9.496c-0,-6.616 1.206,-9.496 4.242,-9.496c3.036,-0 4.242,2.88 4.242,9.496Zm-29.242,-67c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm0.512,9.834c-7.122,-0 -12.609,5.098 -12.609,14.127c-0,9.263 5.215,14.205 12.532,14.205c4.164,0 7.083,-1.634 9.068,-3.658l-2.88,-3.697c-1.518,1.206 -3.153,2.413 -5.838,2.413c-3.697,-0 -6.266,-2.763 -6.266,-9.263c-0,-6.616 2.724,-9.379 6.149,-9.379c2.102,-0 3.892,0.778 5.371,1.984l3.113,-3.775c-2.257,-1.868 -4.748,-2.957 -8.64,-2.957Z"/>
  </g>
</svg></span></a><a class="icon-link svg-link" href="https://github.com/typelevel/cats"><span title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a><a class="icon-link" href="https://discord.gg/XF3CXcMzqD"><i class="icofont-laika" title="Chat">&#xeed5;</i></a><a class="icon-link" href="https://twitter.com/typelevel"><i class="icofont-laika" title="Twitter">&#xed7a;</i></a></span>

    </header>

    <nav id="sidebar">

      <div class="row">
        <a class="icon-link svg-link" href="https://www.javadoc.io/doc/org.typelevel/cats-docs_2.13/2.9.0/"><span title="API"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M75,47.5c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm-50,-0c13.246,-0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,-0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm2.705,16.735l7.239,0l0.622,-4.904l-21.833,0l-0,4.904l7.589,0l0,22.067l6.383,0l-0,-22.067Zm58.076,7.265c-0,-8.757 -3.698,-14.166 -10.781,-14.166c-7.083,-0 -10.781,5.604 -10.781,14.166c0,8.757 3.698,14.166 10.781,14.166c7.083,0 10.781,-5.604 10.781,-14.166Zm-6.539,0c0,6.538 -1.128,9.496 -4.242,9.496c-2.997,0 -4.242,-2.88 -4.242,-9.496c-0,-6.616 1.206,-9.496 4.242,-9.496c3.036,-0 4.242,2.88 4.242,9.496Zm-29.242,-67c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm0.512,9.834c-7.122,-0 -12.609,5.098 -12.609,14.127c-0,9.263 5.215,14.205 12.532,14.205c4.164,0 7.083,-1.634 9.068,-3.658l-2.88,-3.697c-1.518,1.206 -3.153,2.413 -5.838,2.413c-3.697,-0 -6.266,-2.763 -6.266,-9.263c-0,-6.616 2.724,-9.379 6.149,-9.379c2.102,-0 3.892,0.778 5.371,1.984l3.113,-3.775c-2.257,-1.868 -4.748,-2.957 -8.64,-2.957Z"/>
  </g>
</svg></span></a><a class="icon-link svg-link" href="https://github.com/typelevel/cats"><span title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a><a class="icon-link" href="https://discord.gg/XF3CXcMzqD"><i class="icofont-laika" title="Chat">&#xeed5;</i></a><a class="icon-link" href="https://twitter.com/typelevel"><i class="icofont-laika" title="Twitter">&#xed7a;</i></a>
      </div>

      <ul class="nav-list">
        <li class="level1"><a href="../index.html">Cats</a></li>
        <li class="level1"><a href="../typeclasses.html">Type Classes</a></li>
        <li class="level1"><a href="../datatypes.html">Data Types</a></li>
        <li class="level1"><a href="../algebra.html">Algebra</a></li>
        <li class="level1"><a href="../alleycats.html">Alleycats</a></li>
        <li class="level1"><a href="../motivations.html">Motivations</a></li>
        <li class="level1"><a href="../resources_for_learners.html">Resources for Learners</a></li>
        <li class="level1"><a href="../jump_start_guide.html">Jump Start Guide</a></li>
        <li class="level1"><a href="../imports.html">Imports</a></li>
        <li class="level1"><a href="../faq.html">FAQ</a></li>
        <li class="level1"><a href="../CONTRIBUTING.html">Contributor guide</a></li>
        <li class="level1"><a href="../ADOPTERS.html">Adopters</a></li>
        <li class="level1"><a href="../colophon.html">Colophon</a></li>
        <li class="level1"><a href="../nomenclature.html">Glossary</a></li>
        <li class="level1"><a href="../guidelines.html">Guidelines</a></li>
        <li class="level1"><a href="../typelevelEcosystem.html">Typelevel Ecosystem</a></li>
        <li class="level1 nav-header">Type Classes</li>
        <li class="level2"><a href="../typeclasses/alternative.html">Alternative</a></li>
        <li class="level2"><a href="../typeclasses/applicative.html">Applicative</a></li>
        <li class="level2"><a href="../typeclasses/applicativemonaderror.html">ApplicativeError and MonadError</a></li>
        <li class="level2"><a href="../typeclasses/applicativetraverse.html">Applicative and Traversable Functors</a></li>
        <li class="level2"><a href="../typeclasses/arrow.html">Arrow</a></li>
        <li class="level2"><a href="../typeclasses/arrowchoice.html">Arrow Choice</a></li>
        <li class="level2"><a href="../typeclasses/bifoldable.html">Bifoldable</a></li>
        <li class="level2"><a href="../typeclasses/bifunctor.html">Bifunctor</a></li>
        <li class="level2"><a href="../typeclasses/bimonad.html">Bimonad</a></li>
        <li class="level2"><a href="../typeclasses/comonad.html">Comonad</a></li>
        <li class="level2"><a href="../typeclasses/contravariant.html">Contravariant</a></li>
        <li class="level2"><a href="../typeclasses/contravariantmonoidal.html">Contravariant Monoidal</a></li>
        <li class="level2"><a href="../typeclasses/eq.html">Eq</a></li>
        <li class="level2"><a href="../typeclasses/foldable.html">Foldable</a></li>
        <li class="level2"><a href="../typeclasses/functor.html">Functor</a></li>
        <li class="level2"><a href="../typeclasses/invariant.html">Invariant</a></li>
        <li class="level2"><a href="../typeclasses/invariantmonoidal.html">Invariant Monoidal</a></li>
        <li class="level2"><a href="../typeclasses/lawtesting.html">Law testing</a></li>
        <li class="level2"><a href="../typeclasses/monad.html">Monad</a></li>
        <li class="level2"><a href="../typeclasses/monoid.html">Monoid</a></li>
        <li class="level2"><a href="../typeclasses/monoidk.html">MonoidK</a></li>
        <li class="level2"><a href="../typeclasses/nonemptytraverse.html">NonEmptyTraverse</a></li>
        <li class="level2"><a href="../typeclasses/parallel.html">Parallel</a></li>
        <li class="level2"><a href="../typeclasses/reducible.html">Reducible</a></li>
        <li class="level2"><a href="../typeclasses/semigroup.html">Semigroup</a></li>
        <li class="level2"><a href="../typeclasses/semigroupk.html">SemigroupK</a></li>
        <li class="level2"><a href="../typeclasses/show.html">Show</a></li>
        <li class="level2"><a href="../typeclasses/traverse.html">Traverse</a></li>
        <li class="level1 nav-header">Data Types</li>
        <li class="level2"><a href="chain.html">Chain</a></li>
        <li class="level2"><a href="const.html">Const</a></li>
        <li class="level2"><a href="contt.html">ContT</a></li>
        <li class="level2 active"><a href="#">Either</a></li>
        <li class="level2"><a href="eithert.html">EitherT</a></li>
        <li class="level2"><a href="eval.html">Eval</a></li>
        <li class="level2"><a href="freeapplicative.html">Free Applicative</a></li>
        <li class="level2"><a href="freemonad.html">Free Monad</a></li>
        <li class="level2"><a href="functionk.html">FunctionK</a></li>
        <li class="level2"><a href="id.html">Id</a></li>
        <li class="level2"><a href="ior.html">Ior</a></li>
        <li class="level2"><a href="iort.html">IorT</a></li>
        <li class="level2"><a href="kleisli.html">Kleisli</a></li>
        <li class="level2"><a href="nel.html">NonEmptyList</a></li>
        <li class="level2"><a href="nested.html">Nested</a></li>
        <li class="level2"><a href="oneand.html">OneAnd</a></li>
        <li class="level2"><a href="optiont.html">OptionT</a></li>
        <li class="level2"><a href="state.html">State</a></li>
        <li class="level2"><a href="validated.html">Validated</a></li>
        <li class="level2"><a href="writer.html">Writer</a></li>
        <li class="level2"><a href="writert.html">WriterT</a></li>
        <li class="level2"><a href="statet.html">StateT</a></li>
      </ul>

      <ul class="nav-list">
        <li class="level1 nav-header">Related Projects</li>
        
          <li class="level2"><a href="https://typelevel.org/cats-effect/">cats-effect</a></li>
        
          <li class="level2"><a href="https://typelevel.org/mouse">Mouse</a></li>
        
          <li class="level2"><a href="https://github.com/typelevel/discipline/">discipline</a></li>
        
      </ul>

    </nav>

    <div id="container">

      <nav id="page-nav">
        <p class="header"><a href="#">Either</a></p>

        <ul class="nav-list">
          <li class="level1"><a href="#either-2">Either</a></li>
          <li class="level2"><a href="#lifting-values-into-an-either">Lifting Values into an Either</a></li>
          <li class="level2"><a href="#either-vs-validated"><code>Either</code> vs <code>Validated</code></a></li>
          <li class="level2"><a href="#syntax">Syntax</a></li>
          <li class="level2"><a href="#example-usage-round-1">Example usage: Round 1</a></li>
          <li class="level2"><a href="#example-usage-round-2">Example usage: Round 2</a></li>
          <li class="level1"><a href="#either-in-the-small-either-in-the-large">Either in the small, Either in the large</a></li>
          <li class="level2"><a href="#solution-1-application-wide-errors">Solution 1: Application-wide errors</a></li>
          <li class="level2"><a href="#solution-2-adts-all-the-way-down">Solution 2: ADTs all the way down</a></li>
          <li class="level1"><a href="#working-with-exception-y-code">Working with exception-y code</a></li>
        </ul>

        <p class="footer"></p>
      </nav>

      <main class="content">

        <h1 id="either-1" class="title">Either</h1>
        <p>In day-to-day programming, it is fairly common to find ourselves writing functions that
        can fail. For instance, querying a service may result in a connection issue, or some
        unexpected JSON response.</p>
        <p>To communicate these errors it has become common practice to throw exceptions. However,
        exceptions are not tracked in any way, shape, or form by the Scala compiler. To see
        what kind of exceptions (if any) a function may throw, we have to dig through the source code.
        Then to handle these exceptions, we have to make sure we catch them at the call site.
        This all becomes even more unwieldy when we try to compose exception-throwing procedures.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">throwsSomeStuff</span><span>: </span><span class="type-name">Int</span><span> =&gt; </span><span class="type-name">Double</span><span> = ???

</span><span class="keyword">val</span><span> </span><span class="identifier">throwsOtherThings</span><span>: </span><span class="type-name">Double</span><span> =&gt; </span><span class="type-name">String</span><span> = ???

</span><span class="keyword">val</span><span> </span><span class="identifier">moreThrowing</span><span>: </span><span class="type-name">String</span><span> =&gt; </span><span class="type-name">List</span><span>[</span><span class="type-name">Char</span><span>] = ???

</span><span class="keyword">val</span><span> </span><span class="identifier">magic</span><span> = </span><span class="identifier">throwsSomeStuff</span><span>.</span><span class="identifier">andThen</span><span>(</span><span class="identifier">throwsOtherThings</span><span>).</span><span class="identifier">andThen</span><span>(</span><span class="identifier">moreThrowing</span><span>)</span></code></pre>
        <p>Assume we happily throw exceptions in our code. Looking at the types, any of those functions
        can throw any number of exceptions, we don&#39;t know. When we compose, exceptions from any of
        the constituent functions can be thrown. Moreover, they may throw the same kind of exception
        (e.g. <code>IllegalArgumentException</code>) and thus it gets tricky tracking exactly where that
        exception came from.</p>
        <p>How then do we communicate an error? By making it explicit in the data type we return.</p>
        
        <h2 id="either-2" class="section">Either<a class="anchor-link right" href="#either-2"><i class="icofont-laika">&#xef71;</i></a></h2>
        
        <h3 id="lifting-values-into-an-either" class="section">Lifting Values into an Either<a class="anchor-link right" href="#lifting-values-into-an-either"><i class="icofont-laika">&#xef71;</i></a></h3>
        <p><code>asRight</code> and <code>asLeft</code> are provided by Cats to lift a value into an Either. The advantage of these operations over the <code>Right</code> and <code>Left</code> constructors provided in the standard library is that the lifted value can help guide type inference.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">all</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">e1</span><span> = </span><span class="number-literal">5</span><span>.</span><span class="identifier">asRight</span><span>[</span><span class="type-name">String</span><span>]
</span><span class="comment">// e1: Either[String, Int] = Right(value = 5)
</span><span class="keyword">val</span><span> </span><span class="identifier">e2</span><span> = </span><span class="string-literal">&quot;error&quot;</span><span>.</span><span class="identifier">asLeft</span><span>[</span><span class="type-name">Int</span><span>]
</span><span class="comment">// e2: Either[String, Int] = Left(value = &quot;error&quot;)</span></code></pre>
        
        <h3 id="either-vs-validated" class="section"><code>Either</code> vs <code>Validated</code><a class="anchor-link right" href="#either-vs-validated"><i class="icofont-laika">&#xef71;</i></a></h3>
        <p>In general, <code>Validated</code> is used to accumulate errors, while <code>Either</code> is used to short-circuit a computation upon the first error. For more information, see the <code>Validated</code> vs <code>Either</code> section of the <a href="validated.html"><code>Validated</code> documentation</a>.</p>
        
        <h3 id="syntax" class="section">Syntax<a class="anchor-link right" href="#syntax"><i class="icofont-laika">&#xef71;</i></a></h3>
        <p>In Scala 2.10.x and 2.11.x, <code>Either</code> is unbiased. That is, usual combinators like <code>flatMap</code> and <code>map</code>
        are missing from it. Instead, you call <code>.right</code> or <code>.left</code> to get a <code>RightProjection</code> or
        <code>LeftProjection</code> (respectively) which does have the combinators. The direction of the projection indicates the direction
        of bias. For instance, calling <code>map</code> on a <code>RightProjection</code> acts on the <code>Right</code> of an <code>Either</code>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">e1</span><span>: </span><span class="type-name">Either</span><span>[</span><span class="type-name">String</span><span>, </span><span class="type-name">Int</span><span>] = </span><span class="type-name">Right</span><span>(</span><span class="number-literal">5</span><span>)
</span><span class="comment">// e1: Either[String, Int] = Right(value = 5)
</span><span class="identifier">e1</span><span>.</span><span class="identifier">right</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">_</span><span> + </span><span class="number-literal">1</span><span>)
</span><span class="comment">// res1: Either[String, Int] = Right(value = 6)
</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">e2</span><span>: </span><span class="type-name">Either</span><span>[</span><span class="type-name">String</span><span>, </span><span class="type-name">Int</span><span>] = </span><span class="type-name">Left</span><span>(</span><span class="string-literal">&quot;hello&quot;</span><span>)
</span><span class="comment">// e2: Either[String, Int] = Left(value = &quot;hello&quot;)
</span><span class="identifier">e2</span><span>.</span><span class="identifier">right</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">_</span><span> + </span><span class="number-literal">1</span><span>)
</span><span class="comment">// res2: Either[String, Int] = Left(value = &quot;hello&quot;)</span></code></pre>
        <p>Note the return types are themselves back to <code>Either</code>, so if we want to make more calls to
        <code>flatMap</code> or <code>map</code> then we again must call <code>right</code> or <code>left</code>.</p>
        <p>However, the convention is almost always to right-bias <code>Either</code>. Indeed in Scala 2.12.x <code>Either</code> is
        <a href="https://github.com/scala/scala/pull/5135">right-biased</a> by default.</p>
        <p>More often than not we want to just bias towards one side and call it a day - by convention,
        the right side is most often chosen. In Scala 2.12.x this convention
        <a href="https://github.com/scala/scala/pull/5135">is implemented</a>
        in the standard library. Since Cats builds on 2.10.x and 2.11.x, the gaps have been filled via syntax
        enrichments available under <code>cats.syntax.either._</code> or <code>cats.implicits._</code>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">right</span><span>: </span><span class="type-name">Either</span><span>[</span><span class="type-name">String</span><span>, </span><span class="type-name">Int</span><span>] = </span><span class="type-name">Right</span><span>(</span><span class="number-literal">5</span><span>)
</span><span class="comment">// right: Either[String, Int] = Right(value = 5)
</span><span class="identifier">right</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">_</span><span> + </span><span class="number-literal">1</span><span>)
</span><span class="comment">// res3: Either[String, Int] = Right(value = 6)
</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">left</span><span>: </span><span class="type-name">Either</span><span>[</span><span class="type-name">String</span><span>, </span><span class="type-name">Int</span><span>] = </span><span class="type-name">Left</span><span>(</span><span class="string-literal">&quot;hello&quot;</span><span>)
</span><span class="comment">// left: Either[String, Int] = Left(value = &quot;hello&quot;)
</span><span class="identifier">left</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">_</span><span> + </span><span class="number-literal">1</span><span>)
</span><span class="comment">// res4: Either[String, Int] = Left(value = &quot;hello&quot;)</span></code></pre>
        <p>For the rest of this tutorial we will assume the syntax enrichment is in scope giving us right-biased <code>Either</code>
        and a bunch of other useful combinators (both on <code>Either</code> and the companion object).</p>
        <p>Because <code>Either</code> is right-biased, it is possible to define a <code>Monad</code> instance for it.
        Since we only ever want the computation to continue in the case of <code>Right</code>, we fix the left type parameter
        and leave the right one free.</p>
        <p><em>Note</em>: the example below assumes usage of the <a href="https://github.com/typelevel/kind-projector">kind-projector compiler plugin</a> and will not compile if it is not being used in a project.</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="type-name">Monad</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">def</span><span> </span><span class="declaration-name">eitherMonad</span><span>[</span><span class="type-name">Err</span><span>]: </span><span class="type-name">Monad</span><span>[</span><span class="type-name">Either</span><span>[</span><span class="type-name">Err</span><span>, *]] =
  </span><span class="keyword">new</span><span> </span><span class="type-name">Monad</span><span>[</span><span class="type-name">Either</span><span>[</span><span class="type-name">Err</span><span>, *]] {
    </span><span class="keyword">def</span><span> </span><span class="declaration-name">flatMap</span><span>[</span><span class="type-name">A</span><span>, </span><span class="type-name">B</span><span>](</span><span class="identifier">fa</span><span>: </span><span class="type-name">Either</span><span>[</span><span class="type-name">Err</span><span>, </span><span class="type-name">A</span><span>])(</span><span class="identifier">f</span><span>: </span><span class="type-name">A</span><span> =&gt; </span><span class="type-name">Either</span><span>[</span><span class="type-name">Err</span><span>, </span><span class="type-name">B</span><span>]): </span><span class="type-name">Either</span><span>[</span><span class="type-name">Err</span><span>, </span><span class="type-name">B</span><span>] =
      </span><span class="identifier">fa</span><span>.</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">f</span><span>)

    </span><span class="keyword">def</span><span> </span><span class="declaration-name">pure</span><span>[</span><span class="type-name">A</span><span>](</span><span class="identifier">x</span><span>: </span><span class="type-name">A</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">Err</span><span>, </span><span class="type-name">A</span><span>] = </span><span class="type-name">Either</span><span>.</span><span class="identifier">right</span><span>(</span><span class="identifier">x</span><span>)

    </span><span class="annotation">@annotation</span><span>.</span><span class="identifier">tailrec</span><span>
    </span><span class="keyword">def</span><span> </span><span class="declaration-name">tailRecM</span><span>[</span><span class="type-name">A</span><span>, </span><span class="type-name">B</span><span>](</span><span class="identifier">a</span><span>: </span><span class="type-name">A</span><span>)(</span><span class="identifier">f</span><span>: </span><span class="type-name">A</span><span> =&gt; </span><span class="type-name">Either</span><span>[</span><span class="type-name">Err</span><span>, </span><span class="type-name">Either</span><span>[</span><span class="type-name">A</span><span>, </span><span class="type-name">B</span><span>]]): </span><span class="type-name">Either</span><span>[</span><span class="type-name">Err</span><span>, </span><span class="type-name">B</span><span>] =
      </span><span class="identifier">f</span><span>(</span><span class="identifier">a</span><span>) </span><span class="keyword">match</span><span> {
        </span><span class="keyword">case</span><span> </span><span class="type-name">Right</span><span>(</span><span class="type-name">Right</span><span>(</span><span class="identifier">b</span><span>)) =&gt; </span><span class="type-name">Either</span><span>.</span><span class="identifier">right</span><span>(</span><span class="identifier">b</span><span>)
        </span><span class="keyword">case</span><span> </span><span class="type-name">Right</span><span>(</span><span class="type-name">Left</span><span>(</span><span class="identifier">a</span><span>)) =&gt; </span><span class="identifier">tailRecM</span><span>(</span><span class="identifier">a</span><span>)(</span><span class="identifier">f</span><span>)
        </span><span class="keyword">case</span><span> </span><span class="identifier">l</span><span class="annotation">@Left</span><span>(</span><span class="identifier">_</span><span>) =&gt; </span><span class="identifier">l</span><span>.</span><span class="identifier">rightCast</span><span>[</span><span class="type-name">B</span><span>] </span><span class="comment">// Cast the right type parameter to avoid allocation
</span><span>      }
  }</span></code></pre>
        
        <h3 id="example-usage-round-1" class="section">Example usage: Round 1<a class="anchor-link right" href="#example-usage-round-1"><i class="icofont-laika">&#xef71;</i></a></h3>
        <p>As a running example, we will have a series of functions that will parse a string into an integer,
        take the reciprocal, and then turn the reciprocal into a string.</p>
        <p>In exception-throwing code, we would have something like this:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">object</span><span> </span><span class="type-name">ExceptionStyle</span><span> {
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">parse</span><span>(</span><span class="identifier">s</span><span>: </span><span class="type-name">String</span><span>): </span><span class="type-name">Int</span><span> =
    </span><span class="keyword">if</span><span> (</span><span class="identifier">s</span><span>.</span><span class="identifier">matches</span><span>(</span><span class="string-literal">&quot;-?[0-9]+&quot;</span><span>)) </span><span class="identifier">s</span><span>.</span><span class="identifier">toInt</span><span>
    </span><span class="keyword">else</span><span> </span><span class="keyword">throw</span><span> </span><span class="keyword">new</span><span> </span><span class="type-name">NumberFormatException</span><span>(</span><span class="string-literal">s&quot;</span><span class="substitution">${s}</span><span class="string-literal"> is not a valid integer.&quot;</span><span>)

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">reciprocal</span><span>(</span><span class="identifier">i</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Double</span><span> =
    </span><span class="keyword">if</span><span> (</span><span class="identifier">i</span><span> == </span><span class="number-literal">0</span><span>) </span><span class="keyword">throw</span><span> </span><span class="keyword">new</span><span> </span><span class="type-name">IllegalArgumentException</span><span>(</span><span class="string-literal">&quot;Cannot take reciprocal of 0.&quot;</span><span>)
    </span><span class="keyword">else</span><span> </span><span class="number-literal">1.0</span><span> / </span><span class="identifier">i</span><span>

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">stringify</span><span>(</span><span class="identifier">d</span><span>: </span><span class="type-name">Double</span><span>): </span><span class="type-name">String</span><span> = </span><span class="identifier">d</span><span>.</span><span class="identifier">toString</span><span>
}</span></code></pre>
        <p>Instead, let&#39;s make the fact that some of our functions can fail explicit in the return type.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">object</span><span> </span><span class="type-name">EitherStyle</span><span> {
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">parse</span><span>(</span><span class="identifier">s</span><span>: </span><span class="type-name">String</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">Exception</span><span>, </span><span class="type-name">Int</span><span>] =
    </span><span class="keyword">if</span><span> (</span><span class="identifier">s</span><span>.</span><span class="identifier">matches</span><span>(</span><span class="string-literal">&quot;-?[0-9]+&quot;</span><span>)) </span><span class="type-name">Either</span><span>.</span><span class="identifier">right</span><span>(</span><span class="identifier">s</span><span>.</span><span class="identifier">toInt</span><span>)
    </span><span class="keyword">else</span><span> </span><span class="type-name">Either</span><span>.</span><span class="identifier">left</span><span>(</span><span class="keyword">new</span><span> </span><span class="type-name">NumberFormatException</span><span>(</span><span class="string-literal">s&quot;</span><span class="substitution">${s}</span><span class="string-literal"> is not a valid integer.&quot;</span><span>))

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">reciprocal</span><span>(</span><span class="identifier">i</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">Exception</span><span>, </span><span class="type-name">Double</span><span>] =
    </span><span class="keyword">if</span><span> (</span><span class="identifier">i</span><span> == </span><span class="number-literal">0</span><span>) </span><span class="type-name">Either</span><span>.</span><span class="identifier">left</span><span>(</span><span class="keyword">new</span><span> </span><span class="type-name">IllegalArgumentException</span><span>(</span><span class="string-literal">&quot;Cannot take reciprocal of 0.&quot;</span><span>))
    </span><span class="keyword">else</span><span> </span><span class="type-name">Either</span><span>.</span><span class="identifier">right</span><span>(</span><span class="number-literal">1.0</span><span> / </span><span class="identifier">i</span><span>)

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">stringify</span><span>(</span><span class="identifier">d</span><span>: </span><span class="type-name">Double</span><span>): </span><span class="type-name">String</span><span> = </span><span class="identifier">d</span><span>.</span><span class="identifier">toString</span><span>
}</span></code></pre>
        <p>Now, using combinators like <code>flatMap</code> and <code>map</code>, we can compose our functions together.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="type-name">EitherStyle</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">def</span><span> </span><span class="declaration-name">magic</span><span>(</span><span class="identifier">s</span><span>: </span><span class="type-name">String</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">Exception</span><span>, </span><span class="type-name">String</span><span>] =
  </span><span class="identifier">parse</span><span>(</span><span class="identifier">s</span><span>).</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">reciprocal</span><span>).</span><span class="identifier">map</span><span>(</span><span class="identifier">stringify</span><span>)</span></code></pre>
        <p>With the composite function that we actually care about, we can pass in strings and then pattern
        match on the exception. Because <code>Either</code> is a sealed type (often referred to as an algebraic data type,
        or ADT), the compiler will complain if we do not check both the <code>Left</code> and <code>Right</code> case.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">magic</span><span>(</span><span class="string-literal">&quot;123&quot;</span><span>) </span><span class="keyword">match</span><span> {
  </span><span class="keyword">case</span><span> </span><span class="type-name">Left</span><span>(</span><span class="identifier">_</span><span>: </span><span class="type-name">NumberFormatException</span><span>) =&gt; </span><span class="identifier">println</span><span>(</span><span class="string-literal">&quot;not a number!&quot;</span><span>)
  </span><span class="keyword">case</span><span> </span><span class="type-name">Left</span><span>(</span><span class="identifier">_</span><span>: </span><span class="type-name">IllegalArgumentException</span><span>) =&gt; </span><span class="identifier">println</span><span>(</span><span class="string-literal">&quot;can&#39;t take reciprocal of 0!&quot;</span><span>)
  </span><span class="keyword">case</span><span> </span><span class="type-name">Left</span><span>(</span><span class="identifier">_</span><span>) =&gt; </span><span class="identifier">println</span><span>(</span><span class="string-literal">&quot;got unknown exception&quot;</span><span>)
  </span><span class="keyword">case</span><span> </span><span class="type-name">Right</span><span>(</span><span class="identifier">s</span><span>) =&gt; </span><span class="identifier">println</span><span>(</span><span class="string-literal">s&quot;Got reciprocal: </span><span class="substitution">${s}</span><span class="string-literal">&quot;</span><span>)
}
</span><span class="comment">// Got reciprocal: 0.008130081300813009</span></code></pre>
        <p>Not bad - if we leave out any of those clauses the compiler will yell at us, as it should. However,
        note the <code>Left(_)</code> clause - the compiler will complain if we leave that out because it knows
        that given the type <code>Either[Exception, String]</code>, there can be inhabitants of <code>Left</code> that are not
        <code>NumberFormatException</code> or <code>IllegalArgumentException</code>. However, we &quot;know&quot; by inspection of the source
        that those will be the only exceptions thrown, so it seems strange to have to account for other exceptions.
        This implies that there is still room to improve.</p>
        
        <h3 id="example-usage-round-2" class="section">Example usage: Round 2<a class="anchor-link right" href="#example-usage-round-2"><i class="icofont-laika">&#xef71;</i></a></h3>
        <p>Instead of using exceptions as our error value, let&#39;s instead enumerate explicitly the things that
        can go wrong in our program.</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">object</span><span> </span><span class="type-name">EitherStyle</span><span> {
  </span><span class="keyword">sealed</span><span> </span><span class="keyword">abstract</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Error</span><span>
  </span><span class="keyword">final</span><span> </span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">NotANumber</span><span>(</span><span class="identifier">string</span><span>: </span><span class="type-name">String</span><span>) </span><span class="keyword">extends</span><span> </span><span class="type-name">Error</span><span>
  </span><span class="keyword">case</span><span> </span><span class="keyword">object</span><span> </span><span class="type-name">NoZeroReciprocal</span><span> </span><span class="keyword">extends</span><span> </span><span class="type-name">Error</span><span>

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">parse</span><span>(</span><span class="identifier">s</span><span>: </span><span class="type-name">String</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">Error</span><span>, </span><span class="type-name">Int</span><span>] =
    </span><span class="keyword">if</span><span> (</span><span class="identifier">s</span><span>.</span><span class="identifier">matches</span><span>(</span><span class="string-literal">&quot;-?[0-9]+&quot;</span><span>)) </span><span class="type-name">Either</span><span>.</span><span class="identifier">right</span><span>(</span><span class="identifier">s</span><span>.</span><span class="identifier">toInt</span><span>)
    </span><span class="keyword">else</span><span> </span><span class="type-name">Either</span><span>.</span><span class="identifier">left</span><span>(</span><span class="type-name">NotANumber</span><span>(</span><span class="identifier">s</span><span>))

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">reciprocal</span><span>(</span><span class="identifier">i</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">Error</span><span>, </span><span class="type-name">Double</span><span>] =
    </span><span class="keyword">if</span><span> (</span><span class="identifier">i</span><span> == </span><span class="number-literal">0</span><span>) </span><span class="type-name">Either</span><span>.</span><span class="identifier">left</span><span>(</span><span class="type-name">NoZeroReciprocal</span><span>)
    </span><span class="keyword">else</span><span> </span><span class="type-name">Either</span><span>.</span><span class="identifier">right</span><span>(</span><span class="number-literal">1.0</span><span> / </span><span class="identifier">i</span><span>)

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">stringify</span><span>(</span><span class="identifier">d</span><span>: </span><span class="type-name">Double</span><span>): </span><span class="type-name">String</span><span> = </span><span class="identifier">d</span><span>.</span><span class="identifier">toString</span><span>

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">magic</span><span>(</span><span class="identifier">s</span><span>: </span><span class="type-name">String</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">Error</span><span>, </span><span class="type-name">String</span><span>] =
    </span><span class="identifier">parse</span><span>(</span><span class="identifier">s</span><span>).</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">reciprocal</span><span>).</span><span class="identifier">map</span><span>(</span><span class="identifier">stringify</span><span>)
}</span></code></pre>
        <p>For our little module, we enumerate any and all errors that can occur. Then, instead of using
        exception classes as error values, we use one of the enumerated cases. Now when we pattern
        match, we get much nicer matching. Moreover, since <code>Error</code> is <code>sealed</code>, no outside code can
        add additional subtypes which we might fail to handle.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="type-name">EitherStyle</span><span>.</span><span class="identifier">_</span><span>

</span><span class="identifier">magic</span><span>(</span><span class="string-literal">&quot;123&quot;</span><span>) </span><span class="keyword">match</span><span> {
  </span><span class="keyword">case</span><span> </span><span class="type-name">Left</span><span>(</span><span class="type-name">NotANumber</span><span>(</span><span class="identifier">_</span><span>)) =&gt; </span><span class="identifier">println</span><span>(</span><span class="string-literal">&quot;not a number!&quot;</span><span>)
  </span><span class="keyword">case</span><span> </span><span class="type-name">Left</span><span>(</span><span class="type-name">NoZeroReciprocal</span><span>) =&gt; </span><span class="identifier">println</span><span>(</span><span class="string-literal">&quot;can&#39;t take reciprocal of 0!&quot;</span><span>)
  </span><span class="keyword">case</span><span> </span><span class="type-name">Right</span><span>(</span><span class="identifier">s</span><span>) =&gt; </span><span class="identifier">println</span><span>(</span><span class="string-literal">s&quot;Got reciprocal: </span><span class="substitution">${s}</span><span class="string-literal">&quot;</span><span>)
}
</span><span class="comment">// Got reciprocal: 0.008130081300813009</span></code></pre>
        
        <h2 id="either-in-the-small-either-in-the-large" class="section">Either in the small, Either in the large<a class="anchor-link right" href="#either-in-the-small-either-in-the-large"><i class="icofont-laika">&#xef71;</i></a></h2>
        <p>Once you start using <code>Either</code> for all your error-handling, you may quickly run into an issue where
        you need to call into two separate modules which give back separate kinds of errors.</p>
        <pre><code class="nohighlight"><span class="keyword">sealed</span><span> </span><span class="keyword">abstract</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">DatabaseError</span><span>
</span><span class="keyword">trait</span><span> </span><span class="type-name">DatabaseValue</span><span>

</span><span class="keyword">object</span><span> </span><span class="type-name">Database</span><span> {
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">databaseThings</span><span>(): </span><span class="type-name">Either</span><span>[</span><span class="type-name">DatabaseError</span><span>, </span><span class="type-name">DatabaseValue</span><span>] = ???
}

</span><span class="keyword">sealed</span><span> </span><span class="keyword">abstract</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">ServiceError</span><span>
</span><span class="keyword">trait</span><span> </span><span class="type-name">ServiceValue</span><span>

</span><span class="keyword">object</span><span> </span><span class="type-name">Service</span><span> {
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">serviceThings</span><span>(</span><span class="identifier">v</span><span>: </span><span class="type-name">DatabaseValue</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">ServiceError</span><span>, </span><span class="type-name">ServiceValue</span><span>] = ???
}</span></code></pre>
        <p>Let&#39;s say we have an application that wants to do database things, and then take database
        values and do service things. Glancing at the types, it looks like <code>flatMap</code> will do it.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">doApp</span><span> = </span><span class="type-name">Database</span><span>.</span><span class="identifier">databaseThings</span><span>().</span><span class="identifier">flatMap</span><span>(</span><span class="type-name">Service</span><span>.</span><span class="identifier">serviceThings</span><span>)</span></code></pre>
        <p>This line will compile and work as expected, no matter if you&#39;re on 2.12 or an earlier
        version of Scala.  The <code>flatMap</code> we get here (either provided by Cats&#39;s <code>Either</code> syntax for
        Scala 2.10 and 2.11, or, in Scala 2.12, a method on <code>Either</code>) has this signature:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">flatMap</span><span>[</span><span class="type-name">AA</span><span> &gt;: </span><span class="type-name">A</span><span>, </span><span class="type-name">Y</span><span>](</span><span class="identifier">f</span><span>: (</span><span class="type-name">B</span><span>) =&gt; </span><span class="type-name">Either</span><span>[</span><span class="type-name">AA</span><span>, </span><span class="type-name">Y</span><span>]): </span><span class="type-name">Either</span><span>[</span><span class="type-name">AA</span><span>, </span><span class="type-name">Y</span><span>]</span></code></pre>
        <p>This <code>flatMap</code> is different from the ones you&#39;ll find on <code>List</code> or <code>Option</code>, for example, in that it
        has two type parameters, with the extra <code>AA</code> parameter allowing us to <code>flatMap</code> into an <code>Either</code>
        with a different type on the left side.</p>
        <p>This behavior is consistent with the covariance of <code>Either</code>, and in some cases it can be convenient,
        but it also makes it easy to run into nasty variance issues - such as <code>Object</code> being inferred as the
        type of the left side, as it is in this case.</p>
        
        <h3 id="solution-1-application-wide-errors" class="section">Solution 1: Application-wide errors<a class="anchor-link right" href="#solution-1-application-wide-errors"><i class="icofont-laika">&#xef71;</i></a></h3>
        <p>We may then be tempted to make our entire application share an error data type.</p>
        <pre><code class="nohighlight"><span class="keyword">sealed</span><span> </span><span class="keyword">abstract</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">AppError</span><span>
</span><span class="keyword">case</span><span> </span><span class="keyword">object</span><span> </span><span class="type-name">DatabaseError1</span><span> </span><span class="keyword">extends</span><span> </span><span class="type-name">AppError</span><span>
</span><span class="keyword">case</span><span> </span><span class="keyword">object</span><span> </span><span class="type-name">DatabaseError2</span><span> </span><span class="keyword">extends</span><span> </span><span class="type-name">AppError</span><span>
</span><span class="keyword">case</span><span> </span><span class="keyword">object</span><span> </span><span class="type-name">ServiceError1</span><span> </span><span class="keyword">extends</span><span> </span><span class="type-name">AppError</span><span>
</span><span class="keyword">case</span><span> </span><span class="keyword">object</span><span> </span><span class="type-name">ServiceError2</span><span> </span><span class="keyword">extends</span><span> </span><span class="type-name">AppError</span><span>

</span><span class="keyword">trait</span><span> </span><span class="type-name">DatabaseValue</span><span>

</span><span class="keyword">object</span><span> </span><span class="type-name">Database</span><span> {
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">databaseThings</span><span>(): </span><span class="type-name">Either</span><span>[</span><span class="type-name">AppError</span><span>, </span><span class="type-name">DatabaseValue</span><span>] = ???
}

</span><span class="keyword">object</span><span> </span><span class="type-name">Service</span><span> {
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">serviceThings</span><span>(</span><span class="identifier">v</span><span>: </span><span class="type-name">DatabaseValue</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">AppError</span><span>, </span><span class="type-name">ServiceValue</span><span>] = ???
}

</span><span class="keyword">def</span><span> </span><span class="declaration-name">doApp</span><span> = </span><span class="type-name">Database</span><span>.</span><span class="identifier">databaseThings</span><span>().</span><span class="identifier">flatMap</span><span>(</span><span class="type-name">Service</span><span>.</span><span class="identifier">serviceThings</span><span>)</span></code></pre>
        <p>This certainly works, or at least it compiles. But consider the case where another module wants to just use
        <code>Database</code>, and gets an <code>Either[AppError, DatabaseValue]</code> back. Should it want to inspect the errors, it
        must inspect <strong>all</strong> the <code>AppError</code> cases, even though it was only intended for <code>Database</code> to use
        <code>DatabaseError1</code> or <code>DatabaseError2</code>.</p>
        
        <h3 id="solution-2-adts-all-the-way-down" class="section">Solution 2: ADTs all the way down<a class="anchor-link right" href="#solution-2-adts-all-the-way-down"><i class="icofont-laika">&#xef71;</i></a></h3>
        <p>Instead of lumping all our errors into one big ADT, we can instead keep them local to each module, and have
        an application-wide error ADT that wraps each error ADT we need.</p>
        <pre><code class="nohighlight"><span class="keyword">sealed</span><span> </span><span class="keyword">abstract</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">DatabaseError</span><span>
</span><span class="keyword">trait</span><span> </span><span class="type-name">DatabaseValue</span><span>

</span><span class="keyword">object</span><span> </span><span class="type-name">Database</span><span> {
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">databaseThings</span><span>(): </span><span class="type-name">Either</span><span>[</span><span class="type-name">DatabaseError</span><span>, </span><span class="type-name">DatabaseValue</span><span>] = ???
}

</span><span class="keyword">sealed</span><span> </span><span class="keyword">abstract</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">ServiceError</span><span>
</span><span class="keyword">trait</span><span> </span><span class="type-name">ServiceValue</span><span>

</span><span class="keyword">object</span><span> </span><span class="type-name">Service</span><span> {
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">serviceThings</span><span>(</span><span class="identifier">v</span><span>: </span><span class="type-name">DatabaseValue</span><span>): </span><span class="type-name">Either</span><span>[</span><span class="type-name">ServiceError</span><span>, </span><span class="type-name">ServiceValue</span><span>] = ???
}

</span><span class="keyword">sealed</span><span> </span><span class="keyword">abstract</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">AppError</span><span>
</span><span class="keyword">object</span><span> </span><span class="type-name">AppError</span><span> {
  </span><span class="keyword">final</span><span> </span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Database</span><span>(</span><span class="identifier">error</span><span>: </span><span class="type-name">DatabaseError</span><span>) </span><span class="keyword">extends</span><span> </span><span class="type-name">AppError</span><span>
  </span><span class="keyword">final</span><span> </span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Service</span><span>(</span><span class="identifier">error</span><span>: </span><span class="type-name">ServiceError</span><span>) </span><span class="keyword">extends</span><span> </span><span class="type-name">AppError</span><span>
}</span></code></pre>
        <p>Now in our outer application, we can wrap/lift each module-specific error into <code>AppError</code> and then
        call our combinators as usual. <code>Either</code> provides a convenient method to assist with this, called <code>Either.leftMap</code> -
        it can be thought of as the same as <code>map</code>, but for the <code>Left</code> side.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">doApp</span><span>: </span><span class="type-name">Either</span><span>[</span><span class="type-name">AppError</span><span>, </span><span class="type-name">ServiceValue</span><span>] =
  </span><span class="type-name">Database</span><span>.</span><span class="identifier">databaseThings</span><span>().</span><span class="identifier">leftMap</span><span>[</span><span class="type-name">AppError</span><span>](</span><span class="type-name">AppError</span><span>.</span><span class="type-name">Database</span><span>).
  </span><span class="identifier">flatMap</span><span>(</span><span class="identifier">dv</span><span> =&gt; </span><span class="type-name">Service</span><span>.</span><span class="identifier">serviceThings</span><span>(</span><span class="identifier">dv</span><span>).</span><span class="identifier">leftMap</span><span>(</span><span class="type-name">AppError</span><span>.</span><span class="type-name">Service</span><span>))</span></code></pre>
        <p>Hurrah! Each module only cares about its own errors as it should be, and more composite modules have their
        own error ADT that encapsulates each constituent module&#39;s error ADT. Doing this also allows us to take action
        on entire classes of errors instead of having to pattern match on each individual one.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">awesome</span><span> =
  </span><span class="identifier">doApp</span><span> </span><span class="keyword">match</span><span> {
    </span><span class="keyword">case</span><span> </span><span class="type-name">Left</span><span>(</span><span class="type-name">AppError</span><span>.</span><span class="type-name">Database</span><span>(</span><span class="identifier">_</span><span>)) =&gt; </span><span class="string-literal">&quot;something in the database went wrong&quot;</span><span>
    </span><span class="keyword">case</span><span> </span><span class="type-name">Left</span><span>(</span><span class="type-name">AppError</span><span>.</span><span class="type-name">Service</span><span>(</span><span class="identifier">_</span><span>))  =&gt; </span><span class="string-literal">&quot;something in the service went wrong&quot;</span><span>
    </span><span class="keyword">case</span><span> </span><span class="type-name">Right</span><span>(</span><span class="identifier">_</span><span>)                   =&gt; </span><span class="string-literal">&quot;everything is alright!&quot;</span><span>
  }</span></code></pre>
        
        <h2 id="working-with-exception-y-code" class="section">Working with exception-y code<a class="anchor-link right" href="#working-with-exception-y-code"><i class="icofont-laika">&#xef71;</i></a></h2>
        <p>There will inevitably come a time when your nice <code>Either</code> code will have to interact with exception-throwing
        code. Handling such situations is easy enough.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">either</span><span>: </span><span class="type-name">Either</span><span>[</span><span class="type-name">NumberFormatException</span><span>, </span><span class="type-name">Int</span><span>] =
  </span><span class="keyword">try</span><span> {
    </span><span class="type-name">Either</span><span>.</span><span class="identifier">right</span><span>(</span><span class="string-literal">&quot;abc&quot;</span><span>.</span><span class="identifier">toInt</span><span>)
  } </span><span class="keyword">catch</span><span> {
    </span><span class="keyword">case</span><span> </span><span class="identifier">nfe</span><span>: </span><span class="type-name">NumberFormatException</span><span> =&gt; </span><span class="type-name">Either</span><span>.</span><span class="identifier">left</span><span>(</span><span class="identifier">nfe</span><span>)
  }
</span><span class="comment">// either: Either[NumberFormatException, Int] = Left(
//   value = java.lang.NumberFormatException: For input string: &quot;abc&quot;
// )</span></code></pre>
        <p>However, this can get tedious quickly. <code>Either</code> has a <code>catchOnly</code> method on its companion object
        (via syntax enrichment) that allows you to pass it a function, along with the type of exception you want to catch, and does the
        above for you.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">either</span><span>: </span><span class="type-name">Either</span><span>[</span><span class="type-name">NumberFormatException</span><span>, </span><span class="type-name">Int</span><span>] =
  </span><span class="type-name">Either</span><span>.</span><span class="identifier">catchOnly</span><span>[</span><span class="type-name">NumberFormatException</span><span>](</span><span class="string-literal">&quot;abc&quot;</span><span>.</span><span class="identifier">toInt</span><span>)
</span><span class="comment">// either: Either[NumberFormatException, Int] = Left(
//   value = java.lang.NumberFormatException: For input string: &quot;abc&quot;
// )</span></code></pre>
        <p>If you want to catch all (non-fatal) throwables, you can use <code>catchNonFatal</code>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">either</span><span>: </span><span class="type-name">Either</span><span>[</span><span class="type-name">Throwable</span><span>, </span><span class="type-name">Int</span><span>] = </span><span class="type-name">Either</span><span>.</span><span class="identifier">catchNonFatal</span><span>(</span><span class="string-literal">&quot;abc&quot;</span><span>.</span><span class="identifier">toInt</span><span>)
</span><span class="comment">// either: Either[Throwable, Int] = Left(
//   value = java.lang.NumberFormatException: For input string: &quot;abc&quot;
// )</span></code></pre>

        <hr style="margin-top: 30px"/>
        <footer style="font-size: 90%; text-align: center">
          cats is a <a href="https://typelevel.org/">Typelevel</a> project distributed under the <a href="https://opensource.org/licenses/MIT">MIT</a> license.
        </footer>

      </main>

    </div>

  </body>
</html>
