<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Typelevel Laika + Helium Theme" />
  <title>Guidelines</title>
  
  <meta name="author" content="cats contributors"/>
  
  <meta name="author" content="Cody Allen"/>
  
  <meta name="author" content="Ross Baker"/>
  
  <meta name="author" content="Arman Bilge"/>
  
  <meta name="author" content="P. Oscar Boykin"/>
  
  <meta name="author" content="Travis Brown"/>
  
  <meta name="author" content="Adelbert Chang"/>
  
  <meta name="author" content="Daniel Esik"/>
  
  <meta name="author" content="Peter Neyens"/>
  
  <meta name="author" content="Rob Norris"/>
  
  <meta name="author" content="Erik Osheim"/>
  
  <meta name="author" content="LukaJCB"/>
  
  <meta name="author" content="Michael Pilquist"/>
  
  <meta name="author" content="Miles Sabin"/>
  
  <meta name="author" content="Daniel Spiewak"/>
  
  <meta name="author" content="Frank Thomas"/>
  
  <meta name="author" content="Sergey Torgashov"/>
  
  <meta name="author" content="Julien Truffaut"/>
  
  <meta name="author" content="Kailuo Wang"/>
  
  
  <meta name="description" content="docs"/>
  
  
  
  <link rel="icon" sizes="32x32" type="image/png" href="https://typelevel.org/img/favicon.png"/>
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:500">
  
  <link rel="stylesheet" type="text/css" href="helium/site/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="helium/site/laika-helium.css" />
  <script src="helium/site/laika-helium.js"></script>
  
  
  <script> /* for avoiding page load transitions */ </script>
</head>

  <body>

    <header id="top-bar" class="light-default dark-default">

  <div class="row">
    <a id="nav-icon">
      <i class="icofont-laika navigationMenu" title="Navigation">&#xefa2;</i>
    </a>
    
    
  </div>

  <a class="image-link" href="https://typelevel.org"><img src="https://typelevel.org/img/logo.svg"></a>

  <div class="row links">
    
    <a class="icon-link svg-link" href="https://www.javadoc.io/doc/org.typelevel/cats-docs_2.13/2.13.0/"><span class="api" title="API"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M75,47.5c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm-50,-0c13.246,-0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,-0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm2.705,16.735l7.239,0l0.622,-4.904l-21.833,0l-0,4.904l7.589,0l0,22.067l6.383,0l-0,-22.067Zm58.076,7.265c-0,-8.757 -3.698,-14.166 -10.781,-14.166c-7.083,-0 -10.781,5.604 -10.781,14.166c0,8.757 3.698,14.166 10.781,14.166c7.083,0 10.781,-5.604 10.781,-14.166Zm-6.539,0c0,6.538 -1.128,9.496 -4.242,9.496c-2.997,0 -4.242,-2.88 -4.242,-9.496c-0,-6.616 1.206,-9.496 4.242,-9.496c3.036,-0 4.242,2.88 4.242,9.496Zm-29.242,-67c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm0.512,9.834c-7.122,-0 -12.609,5.098 -12.609,14.127c-0,9.263 5.215,14.205 12.532,14.205c4.164,0 7.083,-1.634 9.068,-3.658l-2.88,-3.697c-1.518,1.206 -3.153,2.413 -5.838,2.413c-3.697,-0 -6.266,-2.763 -6.266,-9.263c-0,-6.616 2.724,-9.379 6.149,-9.379c2.102,-0 3.892,0.778 5.371,1.984l3.113,-3.775c-2.257,-1.868 -4.748,-2.957 -8.64,-2.957Z"/>
  </g>
</svg></span></a>
    
    <a class="icon-link svg-link" href="https://github.com/typelevel/cats"><span class="github" title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a>
    
    <a class="icon-link glyph-link" href="https://discord.gg/XF3CXcMzqD"><i class="icofont-laika chat" title="Chat">&#xeed5;</i></a>
    
    <a class="icon-link svg-link" href="https://fosstodon.org/@typelevel"><span class="mastodon" title="Mastodon"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <g class="svg-shape">
    <path d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z"/>
  </g>
</svg></span></a>
    
  </div>  

</header>
    
    <nav id="sidebar">

  <div class="row">
    
    <a class="icon-link svg-link" href="https://www.javadoc.io/doc/org.typelevel/cats-docs_2.13/2.13.0/"><span class="api" title="API"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M75,47.5c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm-50,-0c13.246,-0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,-0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm2.705,16.735l7.239,0l0.622,-4.904l-21.833,0l-0,4.904l7.589,0l0,22.067l6.383,0l-0,-22.067Zm58.076,7.265c-0,-8.757 -3.698,-14.166 -10.781,-14.166c-7.083,-0 -10.781,5.604 -10.781,14.166c0,8.757 3.698,14.166 10.781,14.166c7.083,0 10.781,-5.604 10.781,-14.166Zm-6.539,0c0,6.538 -1.128,9.496 -4.242,9.496c-2.997,0 -4.242,-2.88 -4.242,-9.496c-0,-6.616 1.206,-9.496 4.242,-9.496c3.036,-0 4.242,2.88 4.242,9.496Zm-29.242,-67c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm0.512,9.834c-7.122,-0 -12.609,5.098 -12.609,14.127c-0,9.263 5.215,14.205 12.532,14.205c4.164,0 7.083,-1.634 9.068,-3.658l-2.88,-3.697c-1.518,1.206 -3.153,2.413 -5.838,2.413c-3.697,-0 -6.266,-2.763 -6.266,-9.263c-0,-6.616 2.724,-9.379 6.149,-9.379c2.102,-0 3.892,0.778 5.371,1.984l3.113,-3.775c-2.257,-1.868 -4.748,-2.957 -8.64,-2.957Z"/>
  </g>
</svg></span></a>
    
    <a class="icon-link svg-link" href="https://github.com/typelevel/cats"><span class="github" title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a>
    
    <a class="icon-link glyph-link" href="https://discord.gg/XF3CXcMzqD"><i class="icofont-laika chat" title="Chat">&#xeed5;</i></a>
    
    <a class="icon-link svg-link" href="https://fosstodon.org/@typelevel"><span class="mastodon" title="Mastodon"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <g class="svg-shape">
    <path d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z"/>
  </g>
</svg></span></a>
    
  </div>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="index.html">Cats</a></li>
    <li class="level1 nav-leaf"><a href="typeclasses.html">Type Classes</a></li>
    <li class="level1 nav-leaf"><a href="datatypes.html">Data Types</a></li>
    <li class="level1 nav-leaf"><a href="algebra.html">Algebra</a></li>
    <li class="level1 nav-leaf"><a href="alleycats.html">Alleycats</a></li>
    <li class="level1 nav-leaf"><a href="motivations.html">Motivations</a></li>
    <li class="level1 nav-leaf"><a href="resources_for_learners.html">Resources for Learners</a></li>
    <li class="level1 nav-leaf"><a href="jump_start_guide.html">Jump Start Guide</a></li>
    <li class="level1 nav-leaf"><a href="imports.html">Imports</a></li>
    <li class="level1 nav-leaf"><a href="faq.html">FAQ</a></li>
    <li class="level1 nav-leaf"><a href="CONTRIBUTING.html">Contributor Guide</a></li>
    <li class="level1 nav-leaf"><a href="ADOPTERS.html">Adopters</a></li>
    <li class="level1 nav-leaf"><a href="colophon.html">Colophon</a></li>
    <li class="level1 nav-leaf"><a href="nomenclature.html">Glossary</a></li>
    <li class="level1 active nav-leaf"><a href="#">Guidelines</a></li>
    <li class="level1 nav-leaf"><a href="typelevelEcosystem.html">Typelevel Ecosystem</a></li>
    <li class="level1 nav-header">Type Classes</li>
    <li class="level2 nav-leaf"><a href="typeclasses/alternative.html">Alternative</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/applicative.html">Applicative</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/applicativemonaderror.html">ApplicativeError and MonadError</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/applicativetraverse.html">Applicative and Traversable Functors</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/arrow.html">Arrow</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/arrowchoice.html">Arrow Choice</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/bifoldable.html">Bifoldable</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/bifunctor.html">Bifunctor</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/bimonad.html">Bimonad</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/comonad.html">Comonad</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/contravariant.html">Contravariant</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/contravariantmonoidal.html">Contravariant Monoidal</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/eq.html">Eq</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/foldable.html">Foldable</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/functor.html">Functor</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/invariant.html">Invariant</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/invariantmonoidal.html">Invariant Monoidal</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/lawtesting.html">Law testing</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/monad.html">Monad</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/monoid.html">Monoid</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/monoidk.html">MonoidK</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/nonemptytraverse.html">NonEmptyTraverse</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/parallel.html">Parallel</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/reducible.html">Reducible</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/semigroup.html">Semigroup</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/semigroupk.html">SemigroupK</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/show.html">Show</a></li>
    <li class="level2 nav-leaf"><a href="typeclasses/traverse.html">Traverse</a></li>
    <li class="level1 nav-header">Data Types</li>
    <li class="level2 nav-leaf"><a href="datatypes/chain.html">Chain</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/const.html">Const</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/contt.html">ContT</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/eithert.html">EitherT</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/eval.html">Eval</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/freeapplicative.html">Free Applicative</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/freemonad.html">Free Monad</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/functionk.html">FunctionK</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/id.html">Id</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/ior.html">Ior</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/iort.html">IorT</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/kleisli.html">Kleisli</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/nel.html">NonEmptyList</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/nested.html">Nested</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/oneand.html">OneAnd</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/optiont.html">OptionT</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/state.html">State</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/statet.html">StateT</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/validated.html">Validated</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/writer.html">Writer</a></li>
    <li class="level2 nav-leaf"><a href="datatypes/writert.html">WriterT</a></li>
  </ul>

</nav>

    <div id="container">

      
<nav id="page-nav">
  <p class="header"><a href="#">Guidelines</a></p>

  <ul class="nav-list">
    <li class="level1 nav-node"><a href="#syntax">Syntax</a></li>
    <li class="level2 nav-leaf"><a href="#composing-implicit-conversions-in-traits">Composing Implicit Conversions in Traits</a></li>
    <li class="level2 nav-leaf"><a href="#ops-classes">Ops Classes</a></li>
    <li class="level2 nav-leaf"><a href="#partially-applied-type">Partially-Applied Type</a></li>
    <li class="level2 nav-leaf"><a href="#implicit-naming">Implicit naming</a></li>
    <li class="level2 nav-leaf"><a href="#implicit-instance-priority">Implicit instance priority</a></li>
    <li class="level2 nav-leaf"><a href="#type-classes-that-only-define-laws">Type classes that ONLY define laws.</a></li>
    <li class="level2 nav-leaf"><a href="#applicative-instances-for-monad-transformers">Applicative instances for monad transformers</a></a></li>
    <li class="level2 nav-leaf"><a href="#classes-extending-anyval">Classes extending AnyVal</a></li>
  </ul>

  <p class="footer"></p>
</nav>


      <main class="content">

        <h1 id="guidelines" class="title">Guidelines</h1>
        <p>All guidelines in Сats should have clear justifications. There is no room for tribal wisdom in a simple library.</p>
        
        <h2 id="syntax" class="section"><a class="anchor-link left" href="#syntax"><i class="icofont-laika link">&#xef71;</i></a>Syntax</h2>
        
        <h3 id="composing-implicit-conversions-in-traits" class="section"><a class="anchor-link left" href="#composing-implicit-conversions-in-traits"><i class="icofont-laika link">&#xef71;</i></a>Composing Implicit Conversions in Traits</h3>
        <p>Implicit syntax conversions provided in publicly-exposed traits should be marked final
        so that any composition of the traits provides conversions that can all be inlined.</p>
        
        <h3 id="ops-classes" class="section"><a class="anchor-link left" href="#ops-classes"><i class="icofont-laika link">&#xef71;</i></a>Ops Classes</h3>
        <p>Ops classes should be marked final and extend AnyVal, to take full advantage of inlining and prevent unnecessary allocations.</p>
        <p>The most notable exception is the case where all of the ops in the class are provided by zero-cost macros anyway,
        for example with Simulacrum.</p>
        
        <h3 id="partially-applied-type" class="section"><a class="anchor-link left" href="#partially-applied-type"><i class="icofont-laika link">&#xef71;</i></a>Partially-Applied Type</h3>
        <p>In Scala, when there are multiple type parameters in a function, either scalac infers all type parameters or the user has to
        specify all of them. Often we have functions where there are one or more types that are inferable but not all of them. For example, there is helper function in <code>OptionT</code> that creates an <code>OptionT[F, A]</code> from an <code>A</code>. It could be written as:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">all</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">data</span><span>.</span><span class="type-name">OptionT</span></code></pre>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">pure</span><span>[</span><span class="type-name">F</span><span>[</span><span class="identifier">_</span><span>], </span><span class="type-name">A</span><span>](</span><span class="identifier">a</span><span>: </span><span class="type-name">A</span><span>)(</span><span class="keyword">implicit</span><span> </span><span class="type-name">F</span><span>: </span><span class="type-name">Applicative</span><span>[</span><span class="type-name">F</span><span>]): </span><span class="type-name">OptionT</span><span>[</span><span class="type-name">F</span><span>, </span><span class="type-name">A</span><span>] =
  </span><span class="type-name">OptionT</span><span>(</span><span class="type-name">F</span><span>.</span><span class="identifier">pure</span><span>(</span><span class="type-name">Some</span><span>(</span><span class="identifier">a</span><span>)))


</span><span class="identifier">pure</span><span>[</span><span class="type-name">List</span><span>, </span><span class="type-name">Int</span><span>](</span><span class="number-literal">1</span><span>)
</span><span class="comment">// res0: OptionT[List, Int] = OptionT(value = List(Some(value = 1)))</span></code></pre>
        <p>Note that the type <code>A</code> should&#39;ve been given by the <code>a: A</code> argument, but since scalac cannot infer <code>F[_]</code>, the user still has to specify all type params.
        In Сats, we use a technique described in
         Rob Norris’s <a href="https://tpolecat.github.io/2015/07/30/infer.html">Kinda-Curried Type Parameters</a> to overcome this restriction of scala inference. Here is a version of the <code>pure</code> using this technique in Сats.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">package</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">data</span><span>

</span><span class="keyword">object</span><span> </span><span class="type-name">OptionT</span><span> {

  </span><span class="keyword">private</span><span>[</span><span class="identifier">data</span><span>] </span><span class="keyword">final</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">PurePartiallyApplied</span><span>[</span><span class="type-name">F</span><span>[</span><span class="identifier">_</span><span>]](</span><span class="keyword">val</span><span> </span><span class="identifier">dummy</span><span>: </span><span class="type-name">Boolean</span><span> = </span><span class="boolean-literal">true</span><span> ) </span><span class="keyword">extends</span><span> </span><span class="type-name">AnyVal</span><span> {
    </span><span class="keyword">def</span><span> </span><span class="declaration-name">apply</span><span>[</span><span class="type-name">A</span><span>](</span><span class="identifier">value</span><span>: </span><span class="type-name">A</span><span>)(</span><span class="keyword">implicit</span><span> </span><span class="type-name">F</span><span>: </span><span class="type-name">Applicative</span><span>[</span><span class="type-name">F</span><span>]): </span><span class="type-name">OptionT</span><span>[</span><span class="type-name">F</span><span>, </span><span class="type-name">A</span><span>] =
      </span><span class="type-name">OptionT</span><span>(</span><span class="type-name">F</span><span>.</span><span class="identifier">pure</span><span>(</span><span class="type-name">Some</span><span>(</span><span class="identifier">value</span><span>)))
  }

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">pure</span><span>[</span><span class="type-name">F</span><span>[</span><span class="identifier">_</span><span>]]: </span><span class="type-name">PurePartiallyApplied</span><span>[</span><span class="type-name">F</span><span>] = </span><span class="keyword">new</span><span> </span><span class="type-name">PurePartiallyApplied</span><span>[</span><span class="type-name">F</span><span>]
}</span></code></pre>
        <p>We introduced an intermediate or, as the name suggested, type parameter partially applied type <code>PurePartiallyApplied</code> to divide the function into two steps: the first step is a construction of the partially applied type, for which the type <code>F[_]</code> is given by the user; the second step is the <code>apply</code> method inside partially applied type, for which the <code>A</code> can be inferred from the argument. Now we can write:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="type-name">OptionT</span><span>.</span><span class="identifier">pure</span><span>[</span><span class="type-name">List</span><span>](</span><span class="number-literal">1</span><span>)
</span><span class="comment">// res1: OptionT[List, Int] = OptionT(value = List(Some(value = 1)))</span></code></pre>
        <p>The user doesn&#39;t need to specify the type <code>A</code> which is given by the parameter.</p>
        <p>You probably noticed that there is a <code>val dummy: Boolean</code> in the <code>PurePartiallyApplied</code> class. This is a trick we used
        to make this intermediate class a <a href="http://docs.scala-lang.org/overviews/core/value-classes.html">Value Class</a> so that there is no cost of allocation, i.e. at runtime, it doesn&#39;t create an instance of <code>PurePartiallyApplied</code>. We also hide this partially applied class by making it package private and placing it inside an object.</p>
        
        <h3 id="implicit-naming" class="section"><a class="anchor-link left" href="#implicit-naming"><i class="icofont-laika link">&#xef71;</i></a>Implicit naming</h3>
        <p>In a widely-used library it&#39;s important to minimize the chance that the names of implicits will be used by others and
        therefore name our implicits according to the following rules:</p>
        <ul>
          <li>Implicits should start with &quot;cats&quot; followed by the package name (where the instance is defined).</li>
          <li>If the package contains <code>instances</code> leave <code>instances</code> out.</li>
          <li>The type and the type class should be mentioned in the name.</li>
          <li>If the instance is for multiple type classes, use <code>InstancesFor</code> instead of a type class name.</li>
          <li>If the instance is for a standard library type add <code>Std</code> after the package. i.e. <code>catsStdShowForVector</code> and <code>catsKernelStdGroupForTuple</code>.</li>
        </ul>
        <p>As an example, an implicit instance of <code>Monoid</code> for <code>List</code> defined in the package <code>Kernel</code> should be named <code>catsKernelStdMonoidForList</code>.</p>
        <p>This rule is relatively flexible. Use what you see appropriate. The goal is to maintain uniqueness and avoid conflicts.</p>
        
        <h3 id="implicit-instance-priority" class="section"><a class="anchor-link left" href="#implicit-instance-priority"><i class="icofont-laika link">&#xef71;</i></a>Implicit instance priority</h3>
        <p>When there are multiple instances provided implicitly, if the type class of them are in the same inheritance hierarchy,
        the instances need to be separated out into different abstract class/traits so that they don&#39;t conflict with each other. The names of these abstract classes/traits should be numbered with a priority with 0 being the highest priority. The abstract classes/trait
        with higher priority inherits from the ones with lower priority. The most specific (whose type class is the lowest in the hierarchy) instance should be placed in the abstract class/ trait with the highest priority.  Here is an example.</p>
        <pre><code class="nohighlight"><span>
</span><span class="keyword">trait</span><span> </span><span class="type-name">Functor</span><span>[</span><span class="type-name">F</span><span>[</span><span class="identifier">_</span><span>]]


</span><span class="keyword">trait</span><span> </span><span class="type-name">Monad</span><span>[</span><span class="type-name">F</span><span>[</span><span class="identifier">_</span><span>]] </span><span class="keyword">extends</span><span> </span><span class="type-name">Functor</span><span>

...
</span><span class="keyword">object</span><span> </span><span class="type-name">Kleisli</span><span> </span><span class="keyword">extends</span><span> </span><span class="type-name">KleisliInstance0</span><span>

</span><span class="keyword">abstract</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">KleisliInstance0</span><span> </span><span class="keyword">extends</span><span> </span><span class="type-name">KleisliInstance1</span><span> {
  </span><span class="keyword">implicit</span><span> </span><span class="keyword">def</span><span> </span><span class="declaration-name">catsDataMonadForKleisli</span><span>[</span><span class="type-name">F</span><span>[</span><span class="identifier">_</span><span>], </span><span class="type-name">A</span><span>]: </span><span class="type-name">Monad</span><span>[</span><span class="type-name">Kleisli</span><span>[</span><span class="type-name">F</span><span>, </span><span class="type-name">A</span><span>, *]] = ...
}

</span><span class="keyword">abstract</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">KleisliInstance1</span><span> {
  </span><span class="keyword">implicit</span><span> </span><span class="keyword">def</span><span> </span><span class="declaration-name">catsDataFunctorForKleisli</span><span>[</span><span class="type-name">F</span><span>[</span><span class="identifier">_</span><span>], </span><span class="type-name">A</span><span>]: </span><span class="type-name">Functor</span><span>[</span><span class="type-name">Kleisli</span><span>[</span><span class="type-name">F</span><span>, </span><span class="type-name">A</span><span>, *]] = ...
}</span></code></pre>
        
        <h3 id="type-classes-that-only-define-laws" class="section"><a class="anchor-link left" href="#type-classes-that-only-define-laws"><i class="icofont-laika link">&#xef71;</i></a>Type classes that ONLY define laws.</h3>
        <p>We can introduce new type classes for the sake of adding laws that don&#39;t apply to the parent type class, e.g. <code>CommutativeSemigroup</code> and
        <code>CommutativeArrow</code>.</p>
        
        <h3 id="applicative-instances-for-monad-transformers" class="section"><a class="anchor-link left" href="#applicative-instances-for-monad-transformers"><i class="icofont-laika link">&#xef71;</i></a>Applicative instances for monad transformers</a></h3>
        <p>We explicitly don&#39;t provide an instance of <code>Applicative</code> for e.g. <code>EitherT[F, String, *]</code> given an <code>Applicative[F]</code>.
        An attempt to construct one without a proper <code>Monad[F]</code> instance would be inconsistent in <code>ap</code> with the provided <code>Monad</code> instance
        for <code>EitherT[F, String, *]</code>. Such an instance will be derived if you use <code>Nested</code> instead:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">_</span><span>, </span><span class="identifier">cats</span><span>.</span><span class="identifier">data</span><span>.</span><span class="identifier">_</span><span>, </span><span class="identifier">cats</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">a</span><span> = </span><span class="type-name">EitherT</span><span>(</span><span class="type-name">List</span><span>(</span><span class="type-name">Left</span><span>(</span><span class="string-literal">&quot;err&quot;</span><span>), </span><span class="type-name">Right</span><span>(</span><span class="number-literal">1</span><span>)))
</span><span class="keyword">val</span><span> </span><span class="identifier">x</span><span> = (</span><span class="identifier">a</span><span> *&gt; </span><span class="identifier">a</span><span>).</span><span class="identifier">value</span><span>
&gt; </span><span class="identifier">x</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">Either</span><span>[</span><span class="type-name">String</span><span>, </span><span class="type-name">Int</span><span>]] = </span><span class="type-name">List</span><span>(</span><span class="type-name">Left</span><span>(</span><span class="string-literal">&quot;err&quot;</span><span>), </span><span class="type-name">Left</span><span>(</span><span class="string-literal">&quot;err&quot;</span><span>), </span><span class="type-name">Right</span><span>(</span><span class="number-literal">1</span><span>))

</span><span class="keyword">val</span><span> </span><span class="identifier">y</span><span> = (</span><span class="identifier">a</span><span>.</span><span class="identifier">toNested</span><span> *&gt; </span><span class="identifier">a</span><span>.</span><span class="identifier">toNested</span><span>).</span><span class="identifier">value</span><span>
&gt; </span><span class="identifier">y</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">Either</span><span>[</span><span class="type-name">String</span><span>, </span><span class="type-name">Int</span><span>]] = </span><span class="type-name">List</span><span>(</span><span class="type-name">Left</span><span>(</span><span class="string-literal">&quot;err&quot;</span><span>), </span><span class="type-name">Left</span><span>(</span><span class="string-literal">&quot;err&quot;</span><span>), </span><span class="type-name">Left</span><span>(</span><span class="string-literal">&quot;err&quot;</span><span>), </span><span class="type-name">Right</span><span>(</span><span class="number-literal">1</span><span>))

</span><span class="identifier">x</span><span> === </span><span class="identifier">y</span><span>
&gt; </span><span class="boolean-literal">false</span></code></pre>
        
        <h3 id="classes-extending-anyval" class="section"><a class="anchor-link left" href="#classes-extending-anyval"><i class="icofont-laika link">&#xef71;</i></a>Classes extending AnyVal</h3>
        <p>AnyVal-extending class constructor parameters must be marked as private.</p>

        
<hr class="footer-rule"/>
<footer>
  cats is a <a href="https://typelevel.org/">Typelevel</a> project distributed under the <a href="https://opensource.org/licenses/MIT">MIT</a> license.
</footer>


      </main>

    </div>

  </body>

</html>